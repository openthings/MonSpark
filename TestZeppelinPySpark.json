{"paragraphs":[{"text":"%pyspark\n\ninput_switch_list=z.input(\"List of down switchs separated by a space\")\n\nlst = [(\"appli1\", \"sw1\"), (\"appli1\", \"sw2\"), (\"appli2\", \"sw2\"), (\"appli1\", \"sw3\"), (\"appli3\", \"sw5\"), \n(\"appli4\", \"sw4\"), (\"appli6\", \"sw6\"), (\"appli7\", \"sw7\"), (\"appli8\", \"sw8\"), (\"appli9\", \"sw9\")]\ndf = sqlContext.createDataFrame(lst, ['appli', 'switch'])\ndf_switchs = df.select(df.switch).distinct()\nz.show(df_switchs)","dateUpdated":"2016-08-12T08:42:33+0200","config":{"colWidth":6,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"switch","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"switch","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{"List of down switchs separated by comma":"sw1 sw2","List of down switchs separated by a space":"sw1 sw3 sw2 sw5"},"forms":{"List of down switchs separated by a space":{"name":"List of down switchs separated by a space","displayName":"List of down switchs separated by a space","type":"input","defaultValue":"","hidden":false}}},"jobName":"paragraph_1470905519408_-502213214","id":"20160811-105159_1838078070","result":{"code":"SUCCESS","type":"TABLE","msg":"switch\nsw1\nsw2\nsw3\nsw4\nsw5\nsw6\nsw7\nsw8\nsw9\n\n","comment":"","msgTable":[[{"value":"sw1"}],[{"value":"sw2"}],[{"value":"sw3"}],[{"value":"sw4"}],[{"value":"sw5"}],[{"value":"sw6"}],[{"value":"sw7"}],[{"value":"sw8"}],[{"value":"sw9"}]],"columnNames":[{"name":"switch","index":0,"aggr":"sum"}],"rows":[["sw1"],["sw2"],["sw3"],["sw4"],["sw5"],["sw6"],["sw7"],["sw8"],["sw9"]]},"dateCreated":"2016-08-11T10:51:59+0200","dateStarted":"2016-08-12T08:27:54+0200","dateFinished":"2016-08-12T08:27:54+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27907"},{"text":"%spark\ndisplay(df)","dateUpdated":"2016-08-12T08:43:15+0200","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470984169978_-723253","id":"20160812-084249_419404909","result":{"code":"ERROR","type":"TEXT","msg":"<console>:28: error: not found: value display\n              display(df)\n              ^\n"},"dateCreated":"2016-08-12T08:42:49+0200","dateStarted":"2016-08-12T08:43:15+0200","dateFinished":"2016-08-12T08:43:15+0200","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:27908"},{"text":"%pyspark\n\nswitchs_down =input_switch_list.split(' ')\n\nprint switchs_down\n\nrdd1 = df.rdd.map(lambda r : (r.appli, r.switch))\n\nrdd2 = rdd1.groupByKey().map(lambda x: (x[0], set(x[1])))\n\ngreen_list = rdd2.filter(lambda (k, v): v.intersection(switch_down) == set([])).map(lambda (k, v) : k)\n                                                    \nprint green_list.collect() ","dateUpdated":"2016-08-12T08:42:43+0200","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":true,"editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470851346728_-1863447958","id":"20160810-194906_836284392","result":{"code":"SUCCESS","type":"TEXT","msg":"[u'sw1', u'sw3', u'sw2', u'sw5']\n[u'appli3', u'appli8', u'appli9', u'appli6', u'appli7', u'appli4']\n"},"dateCreated":"2016-08-10T19:49:06+0200","dateStarted":"2016-08-12T08:27:54+0200","dateFinished":"2016-08-12T08:27:54+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27909"},{"text":"%pyspark\n\nemptySet = set()\n\ngreen_list = rdd2.filter(lambda (k, v): not(v.issubset(switchs_down))).filter(\n                                                    lambda (k, v) : v.intersection(switch_down) == emptySet) \n                                                    ).map(lambda (k, v) : k)\n\nprint 'green', green_list.collect()\n\nred_list = rdd2.filter(lambda (k, v): v.issubset(switchs_down)).map(lambda (k,v) : k)\n\nyellow_list = rdd2.filter(lambda (k, v): not(v.issubset(switchs_down))).filter(\n                                                    lambda (k, v) : v.intersection(switch_down) != emptySet \n                                                    ).map(lambda (k, v) : k)\n                                                    \n\ngreen_list2 = green_list.map(lambda x : (x, \"green\"))\nred_list2 = red_list.map(lambda x : (x, \"red\"))\nyellow_list2 = yellow_list.map(lambda x : (x, \"yellow\"))\n\ndf_g= green_list2.toDF(['Application_Name', 'Resilience Status'])\n\nschema = StructType([])\ndf_r = sqlContext.createDataFrame(sc.emptyRDD(), schema)\n\nif (red_list2.count() > 0):\n    df_r= red_list2.toDF(['Application_Name', 'Resilience Status'])\n\nif (yellow_list2.count() > 0):\n    df_y= yellow_list2.toDF(['Application_Name', 'Resilience Status'])\n\nif (df_r.count()>0):\n    df = df_r.unionAll(df_y)\nelse:\n    df =df_y \n\nsqlContext.registerDataFrameAsTable(df, \"df_resultat\")","dateUpdated":"2016-08-12T08:42:46+0200","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470909562526_-5420011","id":"20160811-115922_508860273","result":{"code":"ERROR","type":"TEXT","msg":"Traceback (most recent call last):\n  File \"/var/folders/z5/b2s3zmxj32vc7s5l_lsfrmf80000gn/T/zeppelin_pyspark-6403369785979442869.py\", line 237, in <module>\n    compiledCode = compile(final_code, \"<string>\", \"exec\")\n  File \"<string>\", line 4\n    ).map(lambda (k, v) : k)\n    ^\nIndentationError: unexpected indent\n"},"dateCreated":"2016-08-11T11:59:22+0200","dateStarted":"2016-08-12T08:27:54+0200","dateFinished":"2016-08-12T08:27:54+0200","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:27910"},{"text":"%sql \nSELECT * FROM df_resultat","dateUpdated":"2016-08-12T08:27:54+0200","config":{"colWidth":6,"graph":{"mode":"table","height":300,"optionOpen":true,"keys":[{"name":"Application_Name","index":0,"aggr":"sum"}],"values":[{"name":"Resilience Status","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"Application_Name","index":0,"aggr":"sum"},"yAxis":{"name":"Resilience Status","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470854239086_1998028800","id":"20160810-203719_1240283961","result":{"code":"SUCCESS","type":"TABLE","msg":"Application_Name\tResilience Status\nappli2\tyellow\nappli1\tyellow\n","comment":"","msgTable":[[{"key":"Resilience Status","value":"appli2"},{"key":"Resilience Status","value":"yellow"}],[{"value":"appli1"},{"value":"yellow"}]],"columnNames":[{"name":"Application_Name","index":0,"aggr":"sum"},{"name":"Resilience Status","index":1,"aggr":"sum"}],"rows":[["appli2","yellow"],["appli1","yellow"]]},"dateCreated":"2016-08-10T20:37:19+0200","dateStarted":"2016-08-12T08:27:54+0200","dateFinished":"2016-08-12T08:27:54+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27911"},{"text":"\n","dateUpdated":"2016-08-12T10:14:49+0200","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorHide":false,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1470863369250_1439478056","id":"20160810-230929_299394399","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2016-08-10T23:09:29+0200","dateStarted":"2016-08-12T08:27:54+0200","dateFinished":"2016-08-12T08:27:54+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27912"}],"name":"Untitled Note 1","id":"2BUHNWEXB","angularObjects":{"2BSWBE44D:shared_process":[],"2BUA2U8X2:shared_process":[],"2BVRW5YW2:shared_process":[],"2BTQH662B:shared_process":[],"2BTEHHT1E:shared_process":[],"2BUVM82RS:shared_process":[],"2BTCNNERZ:shared_process":[],"2BUSM9YS9:shared_process":[],"2BSBHTEHY:shared_process":[],"2BSZKKFER:shared_process":[],"2BSN48B1P:shared_process":[],"2BU5HDWN4:shared_process":[],"2BVCF12R3:shared_process":[],"2BTB6CBX4:shared_process":[],"2BVKA5PRZ:shared_process":[],"2BS6R29V1:shared_process":[],"2BTZ78SJP:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}